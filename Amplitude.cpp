#include "Amplitude.h"
#include "KMatrix.h"

Amplitude::Amplitude() {
  kmat_f0 = KMatrix(5, 5);
  f0_mchannels = {
    {0.13498, 0.13498},
    {0.26995, 0.26995},
    {0.49368, 0.49761},
    {0.54786, 0.54786},
    {0.54786, 0.95778}
  };
  f0_malphas = {0.51461, 0.90630, 1.23089, 1.46104, 1.69611};
  f0_galphas = {
    {+0.74987, -0.01257, +0.02736, -0.15102, +0.36103},
    {+0.06401, +0.00204, +0.77413, +0.50999, +0.13112},
    {-0.23417, -0.01032, +0.72283, +0.11934, +0.36792},
    {+0.01570, +0.26700, +0.09214, +0.02742, -0.04025},
    {-0.14242, +0.22780, +0.15981, +0.16272, -0.17397}
  };
  f0_cbkg = {
    {+0.03728, +0.00000, -0.01398, -0.02203, +0.01397},
    {+0.00000, +0.00000, +0.00000, +0.00000, +0.00000},
    {-0.01398, +0.00000, +0.02349, +0.03101, -0.04003},
    {-0.02203, +0.00000, +0.03101, -0.13769, -0.06722},
    {+0.01397, +0.00000, -0.04003, -0.06722, -0.28401}
  };
  kmat_f0.initialize(f0_malphas, f0_mchannels, f0_galphas.t(), f0_cbkg, 0);

  kmat_f2 = KMatrix(4, 4);
  f2_mchannels = {
    {0.13498, 0.13498},
    {0.26995, 0.26995},
    {0.49368, 0.49761},
    {0.54786, 0.54786}
  };
  f2_malphas = {1.15299, 1.48359, 1.72923, 1.96700};
  f2_galphas = {
    {+0.40033, +0.15479, -0.08900, -0.00113},
    {+0.01820, +0.17300, +0.32393, +0.15256},
    {-0.06709, +0.22941, -0.43133, +0.23721},
    {-0.49924, +0.19295, +0.27975, -0.03987}
  };
  f2_cbkg = {
    {-0.04319, +0.00000, +0.00984, +0.01028},
    {+0.00000, +0.00000, +0.00000, +0.00000},
    {+0.00984, +0.00000, -0.07344, +0.05533},
    {+0.01028, +0.00000, +0.05533, -0.05183}
  };
  kmat_f2.initialize(f2_malphas, f2_mchannels, f2_galphas.t(), f2_cbkg, 2);

  kmat_a0 = KMatrix(2, 2);
  a0_mchannels = {
    {0.13498, 0.54786},
    {0.49368, 0.49761}
  };
  a0_malphas = {0.95395, 1.26767};
  a0_galphas = {
    {+0.43215, -0.28825},
    {+0.19000, +0.43372}
  };
  a0_cbkg = {
    {+0.00000, +0.00000},
    {+0.00000, +0.00000},
  };
  kmat_a0.initialize(a0_malphas, a0_mchannels, a0_galphas.t(), a0_cbkg, 0);

  kmat_a2 = KMatrix(3, 2);
  a2_mchannels = {
    {0.13498, 0.54786},
    {0.49368, 0.49761},
    {0.13498, 0.95778}
  };
  a2_malphas = {1.30080, 1.75351};
  a2_galphas = {
    {+0.30073, +0.21426, -0.09162},
    {+0.68567, +0.12543, +0.00184}
  };
  a2_cbkg = {
    {-0.40184, +0.00033, -0.08707},
    {+0.00033, -0.21416, -0.06193},
    {-0.08707, -0.06193, -0.17435}
  };
  kmat_a2.initialize(a2_malphas, a2_mchannels, a2_galphas.t(), a2_cbkg, 2);
}

double Amplitude::intensity(const double& s, const cx_vec& betas) {

}
